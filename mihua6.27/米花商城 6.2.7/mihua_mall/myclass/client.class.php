<?php
 class client { private $ps_api_url, $ps_auth_key, $ps_vsersion; public function __construct($ps_api_url = "\61\62\x37\56\x30\x2e\60\x2e\61", $ps_auth_key = '', $ps_vsersion = "\x31") { goto z14Nz; Vvx6S: $this->ps_auth_key = $ps_auth_key; goto V10fd; z14Nz: $this->ps_api_url = $ps_api_url; goto Vvx6S; V10fd: $this->ps_vsersion = $ps_vsersion; goto X0TD7; X0TD7: } public function ps_member_register($username, $password, $email, $regip = '', $random = '') { goto LzR89; GJRxe: return -3; goto K0pkF; hHpuD: return $this->_ps_send("\x72\x65\x67\x69\163\164\145\x72", array("\x75\x73\x65\162\x6e\x61\155\x65" => $username, "\x70\x61\163\163\167\x6f\x72\x64" => $password, "\x65\155\141\x69\154" => $email, "\x72\145\x67\x69\160" => $regip, "\x72\x61\x6e\144\157\155" => $random)); goto sDoEB; K0pkF: W1SYW: goto hHpuD; LzR89: if ($this->_is_email($email)) { goto W1SYW; } goto GJRxe; sDoEB: } public function ps_member_login($username, $password, $isemail = 0) { goto LskLO; GZWN1: mQ1si: goto EYt0d; gXqf1: $return = $this->_ps_send("\x6c\x6f\x67\151\156", array("\x65\155\141\x69\154" => $username, "\x70\141\163\x73\x77\157\162\x64" => $password)); goto GZWN1; nw_RM: $return = $this->_ps_send("\154\157\x67\x69\x6e", array("\165\163\145\x72\x6e\141\155\145" => $username, "\x70\x61\163\x73\x77\x6f\162\144" => $password)); goto CYAhP; LskLO: if ($isemail) { goto ebUGM; } goto nw_RM; kqi1m: if ($this->_is_email($username)) { goto QYBTz; } goto Vp2yg; Fgfcz: ebUGM: goto kqi1m; EYt0d: return $return; goto CW5wn; Vp2yg: return -3; goto G_8H1; CYAhP: goto mQ1si; goto Fgfcz; G_8H1: QYBTz: goto gXqf1; CW5wn: } public function ps_member_synlogin($uid) { $uid = intval($uid); return $this->_ps_send("\163\x79\156\154\157\x67\x69\156", array("\x75\x69\x64" => $uid)); } public function ps_member_synlogout() { return $this->_ps_send("\163\171\x6e\154\157\x67\157\165\164", array("\60" => 0)); } public function ps_member_edit($username, $email, $password = '', $newpassword = '', $uid = '', $random = '') { goto lRUD7; siovw: return -5; goto UD1jn; l0x2O: return -4; goto f2Wa0; x6M4u: if (!(!empty($username) && !is_string($username) || !empty($email) && !is_string($email) || !empty($password) && !is_string($password) || !empty($newpassword) && !is_string($newpassword))) { goto hYx4M; } goto siovw; f2Wa0: K08Qi: goto x6M4u; lRUD7: if (!($email && !$this->_is_email($email))) { goto K08Qi; } goto l0x2O; UD1jn: hYx4M: goto h1VVm; h1VVm: return $this->_ps_send("\x65\x64\151\x74", array("\x75\163\145\x72\x6e\x61\155\145" => $username, "\160\141\163\163\167\x6f\x72\x64" => $password, "\x6e\x65\167\160\x61\163\163\x77\x6f\162\144" => $newpassword, "\x65\x6d\x61\x69\154" => $email, "\x75\151\144" => $uid, "\162\x61\156\144\x6f\155" => $random)); goto ZJRK_; ZJRK_: } public function ps_updateavatar($uid, $avatar) { return $this->_ps_send("\x75\x70\144\x61\x74\145\x61\166\x61\164\141\162", array("\x75\151\x64" => $uid, "\141\x76\x61\164\x61\162" => $avatar)); } public function ps_deleteavatar($uid) { return $this->_ps_send("\x64\x65\x6c\x65\164\x65\x61\166\141\164\x61\x72", array("\165\151\x64" => $uid)); } public function ps_get_member_info($mix, $type = 1) { goto yTHpc; o3Xu1: goto aF_wB; goto ITf2u; cgd1d: $userinfo = $this->_ps_send("\x67\145\164\165\163\145\x72\x69\x6e\x66\x6f", array("\x75\151\x64" => $mix)); goto Njv0y; Njv0y: goto aF_wB; goto GgMw5; ab3jJ: if ($type == 3) { goto vFdTd; } goto WOY3a; z9Upx: if ($userinfo) { goto cnhT7; } goto X74GF; j87G4: cnhT7: goto L8ioW; ITf2u: vFdTd: goto iKQRV; oR_Vs: QTt1j: goto cgd1d; oL9fq: if ($type == 2) { goto eMY_I; } goto ab3jJ; WOY3a: goto aF_wB; goto oR_Vs; tM26R: $userinfo = $this->_ps_send("\147\x65\x74\165\x73\x65\x72\151\x6e\x66\157", array("\145\x6d\141\x69\x6c" => $mix)); goto C2jiy; X74GF: return -1; goto fSXzd; Jr_co: $userinfo = $this->_ps_send("\x67\145\x74\165\163\x65\x72\151\156\146\x6f", array("\x75\163\145\162\x6e\x61\x6d\x65" => $mix)); goto o3Xu1; GgMw5: eMY_I: goto Jr_co; PJC76: Zfq9Y: goto tM26R; C2jiy: aF_wB: goto z9Upx; fSXzd: goto t5BWD; goto j87G4; C6CeK: t5BWD: goto hRxfT; L8ioW: return $userinfo; goto C6CeK; yTHpc: if ($type == 1) { goto QTt1j; } goto oL9fq; iKQRV: if ($this->_is_email($mix)) { goto Zfq9Y; } goto AjNvE; AjNvE: return -4; goto PJC76; hRxfT: } public function ps_delete_member($mix, $type = 1) { goto kp_cR; r5nfX: ACG4C: goto JcHQS; jfyIY: goto kIQeN; goto CVGQh; gvbFf: return -4; goto r5nfX; kp_cR: if ($type == 1) { goto xO5k5; } goto AVlny; tRAwi: if ($type == 3) { goto tsAbA; } goto qZjLf; iC3TS: $res = $this->_ps_send("\x64\x65\x6c\x65\164\145", array("\165\x73\145\162\x6e\x61\x6d\145" => $mix)); goto W5tWE; JcHQS: $res = $this->_ps_send("\144\x65\154\x65\164\145", array("\x65\155\141\x69\x6c" => $mix)); goto hL_Vq; ugzVQ: return $res; goto PhpnY; CVGQh: ySHKj: goto iC3TS; ppsZV: tsAbA: goto G7Wa3; W5tWE: goto kIQeN; goto ppsZV; V1tbW: xO5k5: goto MUC4K; qZjLf: goto kIQeN; goto V1tbW; hL_Vq: kIQeN: goto ugzVQ; MUC4K: $res = $this->_ps_send("\144\145\x6c\145\164\145", array("\x75\151\x64" => $mix)); goto jfyIY; AVlny: if ($type == 2) { goto ySHKj; } goto tRAwi; G7Wa3: if ($this->_is_email($mix)) { goto ACG4C; } goto gvbFf; PhpnY: } public function ps_checkname($username) { return $this->_ps_send("\143\x68\145\143\153\x6e\x61\x6d\x65", array("\165\x73\x65\x72\x6e\141\x6d\x65" => $username)); } public function ps_checkemail($email) { return $this->_ps_send("\143\x68\145\143\x6b\145\155\x61\151\x6c", array("\x65\155\x61\151\x6c" => $email)); } public function ps_getapplist() { return $this->_ps_send("\147\x65\164\141\x70\160\154\151\x73\x74", array()); } public function ps_getcreditlist() { return $this->_ps_send("\147\x65\x74\143\162\145\x64\151\x74", array()); } public function ps_changecredit($uid, $from, $toappid, $to, $credit) { return $this->_ps_send("\x63\150\x61\156\x67\145\x63\x72\145\144\151\164", array("\x75\x69\x64" => $uid, "\x66\x72\157\155" => $from, "\x74\157\x61\160\x70\x69\144" => $toappid, "\164\157" => $to, "\143\162\145\x64\151\x74" => $credit)); } public function ps_getavatar($uid) { goto miMfL; rRzlV: goto nLPsg; goto vVf7f; fNCSN: $userinfo = unserialize($userinfo); goto aBxR2; vVf7f: WAtk3: goto sIcyG; CihBp: $dir1 = ceil($uid / 10000); goto Gps1J; sIcyG: $avatar = array("\61\70\60" => $userinfo["\x61\166\x61\x74\141\x72\x75\162\154"], "\x39\60" => $userinfo["\x61\x76\x61\164\x61\x72\x75\x72\154"], "\x34\x35" => $userinfo["\x61\166\141\164\x61\162\165\x72\154"], "\x33\60" => $userinfo["\x61\166\x61\x74\141\x72\x75\162\x6c"]); goto cV6ql; lOAuX: if (!($userinfo != -1)) { goto Ak2qP; } goto fNCSN; cV6ql: nLPsg: goto HPB9v; aBxR2: Ak2qP: goto jLZ5o; jLZ5o: if (isset($userinfo["\141\x76\141\x74\141\x72\x75\x72\154"]) && !empty($userinfo["\141\x76\x61\x74\x61\162\165\x72\x6c"]) && $userinfo["\x66\x69\x6c\145"] == 0) { goto WAtk3; } goto CihBp; miMfL: $userinfo = $this->_ps_send("\147\x65\164\x61\x76\x61\x74\141\x72", array("\x75\x69\144" => $uid)); goto lOAuX; HPB9v: return $avatar; goto UtKsS; BcaUq: $avatar = array("\61\70\x30" => $url . "\x31\x38\x30\x78\x31\x38\60\x2e\152\x70\x67", "\x39\x30" => $url . "\x39\x30\x78\x39\60\56\x6a\x70\147", "\x34\65" => $url . "\64\x35\x78\64\65\56\152\x70\x67", "\63\x30" => $url . "\x33\60\170\63\x30\x2e\152\x70\147"); goto rRzlV; Gps1J: $dir2 = ceil($uid % 10000 / 1000); goto QF2cv; QF2cv: $url = $this->ps_api_url . "\57\165\160\x6c\157\x61\x64\x66\x69\x6c\x65\57\141\x76\x61\x74\x61\x72\x2f" . $dir1 . "\x2f" . $dir2 . "\57" . $uid . "\57"; goto BcaUq; UtKsS: } function sys_auth($string, $operation = "\x45\116\103\x4f\x44\105", $key = '', $expiry = 0) { goto B65zV; jBEkb: $box[$i] = $box[$j]; goto fbGa5; SkD0_: goto octxc; goto kbapI; arKFr: goto b9bjX; goto ORVyx; urlHN: $j = ($j + $box[$a]) % 256; goto nMmAW; VBwXU: goto rXAPt; goto mS_3_; vL4B8: return substr($result, 26); goto aJXpu; u9jqO: $keya = md5(substr($key, 0, 16)); goto fV6Aw; kH5uA: $keyc = $ckey_length ? $operation == "\x44\105\x43\x4f\x44\x45" ? substr($string, 0, $ckey_length) : substr(md5(microtime()), -$ckey_length) : ''; goto O2dvd; vON_T: $string_length = strlen($string); goto Cer1a; GoRVu: rEY91: goto fGnki; sIMmu: octxc: goto OqKZ2; vLfPJ: goto tENvD; goto GoRVu; GVOzb: $string = $operation == "\x44\x45\103\x4f\104\x45" ? base64_decode(strtr(substr($string, $ckey_length), "\55\x5f", "\x2b\57")) : sprintf("\45\x30\61\x30\144", $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string; goto vON_T; qf_sj: $j = ($j + $box[$i] + $rndkey[$i]) % 256; goto ab0k_; Pi0Y9: LlHa4: goto SgSqJ; VCEOw: return $keyc . rtrim(strtr(base64_encode($result), "\x2b\57", "\x2d\x5f"), "\75"); goto Bpest; fV6Aw: $keyb = md5(substr($key, 16, 16)); goto kH5uA; srtrH: if (!($i <= 255)) { goto HF3Jo; } goto Tt9uJ; uX6gb: if ($operation == "\x44\x45\103\117\104\x45") { goto j5Due; } goto VCEOw; nMmAW: $tmp = $box[$a]; goto fYzUd; O2dvd: $cryptkey = $keya . md5($keya . $keyc); goto UrMdS; npPNH: tEas3: goto jN5n4; fGnki: $a = $j = $i = 0; goto sIMmu; ORVyx: gVvbf: goto vL4B8; O8sJj: Uu_Ic: goto zQ93R; U4ZNm: $i = 0; goto uu8gJ; l2J4M: $box = range(0, 255); goto H62i2; zQ93R: $i++; goto vLfPJ; jN5n4: $i++; goto SkD0_; Bpest: goto LlHa4; goto RHM8b; RHM8b: j5Due: goto Itlmj; fYzUd: $box[$a] = $box[$j]; goto aLkfe; L87Tn: $result .= chr(ord($string[$i]) ^ $box[($box[$a] + $box[$j]) % 256]); goto npPNH; ewLSx: if (!($i < 256)) { goto rEY91; } goto qf_sj; Tt9uJ: $rndkey[$i] = ord($cryptkey[$i % $key_length]); goto lTEks; kXRnQ: $i++; goto VBwXU; uu8gJ: rXAPt: goto srtrH; OqKZ2: if (!($i < $string_length)) { goto vnALB; } goto uT1Dh; UrMdS: $key_length = strlen($cryptkey); goto GVOzb; lTEks: ImbLU: goto kXRnQ; fbGa5: $box[$j] = $tmp; goto O8sJj; aJXpu: b9bjX: goto Pi0Y9; B65zV: $ckey_length = 4; goto d7iZZ; aLkfe: $box[$j] = $tmp; goto L87Tn; HD5G8: tENvD: goto ewLSx; a7YGs: return ''; goto arKFr; H62i2: $rndkey = array(); goto U4ZNm; ab0k_: $tmp = $box[$i]; goto jBEkb; mS_3_: HF3Jo: goto nhWXD; d7iZZ: $key = md5($key != '' ? $key : $this->ps_auth_key); goto u9jqO; nhWXD: $j = $i = 0; goto HD5G8; Cer1a: $result = ''; goto l2J4M; Itlmj: if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) && substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) { goto gVvbf; } goto a7YGs; kbapI: vnALB: goto uX6gb; uT1Dh: $a = ($a + 1) % 256; goto urlHN; SgSqJ: } public function array2string($data, $isformdata = 1) { goto pVzUq; NtSd4: c0sDS: goto B5lPP; UMpxZ: return ''; goto CBa9Y; pVzUq: if (!($data == '' || empty($data))) { goto qwkwG; } goto UMpxZ; OHPFV: $data = $this->new_stripslashes($data); goto NtSd4; CBa9Y: qwkwG: goto KAFwI; hbXW_: return addslashes(var_export($data, TRUE)); goto fWDkY; B5lPP: return addslashes(json_encode($data, JSON_UNESCAPED_UNICODE)); goto hbXW_; KAFwI: if (!$isformdata) { goto c0sDS; } goto OHPFV; fWDkY: } public function new_stripslashes($string) { goto ivU74; Ivkpa: return stripslashes($string); goto CKwI3; Vvx4q: return $string; goto dc7Tl; ivU74: if (is_array($string)) { goto KoQGu; } goto Ivkpa; MmhE8: foreach ($string as $key => $val) { $string[$key] = $this->new_stripslashes($val); Xbt31: } goto LTvpy; CKwI3: KoQGu: goto MmhE8; LTvpy: xsL13: goto Vvx4q; dc7Tl: } public function auth_data($data) { goto RfDrn; B3ZfE: return $auth_s; goto DIoKj; Te2o8: uelvr: goto NA70j; NA70j: $auth_s = "\166\75" . $this->ps_vsersion . "\x26\x64\x61\x74\141\75" . urlencode($this->sys_auth($s)); goto B3ZfE; H3GOY: foreach ($data as $k => $v) { goto iHIls; MqwvQ: $s .= "{$sep}{$k}\x3d" . $this->_ps_stripslashes($v); goto SPKDo; uTxS6: foreach ($v as $k2 => $v2) { goto ZFPdT; ZFPdT: $s2 .= "{$sep2}{$k}\133{$k2}\135\x3d" . $this->_ps_stripslashes($v2); goto Qp9wn; Qp9wn: $sep2 = "\46"; goto BhU4H; BhU4H: ewKSx: goto AlhyA; AlhyA: } goto RnSsl; iHIls: if (is_array($v)) { goto AMH_B; } goto MqwvQ; i7aPZ: $sep = "\x26"; goto pdBxP; vd6CD: $s2 = $sep2 = ''; goto uTxS6; UnXqu: $s .= $sep . $s2; goto w896U; pdBxP: e610V: goto NvFXA; e3C34: AMH_B: goto vd6CD; SPKDo: goto Wwo4N; goto e3C34; w896U: Wwo4N: goto i7aPZ; RnSsl: plb3d: goto UnXqu; NvFXA: } goto Te2o8; RfDrn: $s = $sep = ''; goto H3GOY; DIoKj: } public function _ps_send($action, $data = null) { return $this->_ps_post($this->ps_api_url . "\57\151\156\144\145\x78\x2e\x70\150\160\x3f\155\75\171\x75\x6e\x26\x61\75" . $action . "\x26\141\x75\x74\x68\x3d" . $this->ps_auth_key, 500000, $this->auth_data($data)); } private function _ps_post($url, $limit = 0, $post = '', $cookie = '', $bysocket = FALSE, $ip = '', $timeout = 156, $block = TRUE) { goto HpUrd; ns_Si: curl_setopt($curl, CURLOPT_POST, 1); goto TNLbW; PVw_7: if (!curl_errno($curl)) { goto Wd7Z0; } goto Zaqrm; StcXd: curl_setopt($curl, CURLOPT_URL, $url); goto WgE2Q; pBImf: curl_setopt($curl, CURLOPT_TIMEOUT, $timeout); goto vdOU8; Zbnr9: Wd7Z0: goto xh1eo; xyYla: if (!$post) { goto SZo1i; } goto ns_Si; WgE2Q: curl_setopt($curl, CURLOPT_USERAGENT, $_SERVER["\x48\x54\124\120\137\125\123\105\122\x5f\x41\x47\x45\116\124"]); goto xyYla; Zaqrm: echo "\74\160\x72\145\x3e\74\x62\x3e\351\224\x99\xe8\xaf\257\72\x3c\x2f\x62\x3e\74\142\x72\40\57\x3e" . curl_error($curl); goto Zbnr9; VwV7Q: $return = curl_exec($curl); goto PVw_7; WwQJI: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto VwV7Q; AcqY7: curl_setopt($curl, CURLOPT_COOKIE, $cookie); goto ZDK4O; TNLbW: curl_setopt($curl, CURLOPT_POSTFIELDS, $post); goto Scal5; okStz: return $return; goto ZscAA; Vacy1: $curl = curl_init(); goto StcXd; vdOU8: curl_setopt($curl, CURLOPT_HEADER, 0); goto WwQJI; HpUrd: $return = ''; goto Vacy1; Scal5: SZo1i: goto GHagq; xh1eo: curl_close($curl); goto okStz; ZDK4O: o1_bE: goto pBImf; GHagq: if (!$cookie) { goto o1_bE; } goto AcqY7; ZscAA: } private function s_ps_post($url, $limit = 8192, $post = '', $cookie = '', $ip = '', $timeout = 150, $block = true) { goto mnk9j; yD3TC: $out .= "\103\157\x6e\x6e\x65\143\164\x69\x6f\x6e\72\40\103\x6c\157\x73\x65\xd\12"; goto b0xen; Ob5iK: $out .= "\110\x6f\163\x74\72\40{$host}\15\12"; goto geqCN; mnk9j: $return = ''; goto IeQBL; MOlkg: stream_set_timeout($fp, $timeout); goto FYG6i; mbxRW: $out .= "\x55\x73\x65\x72\x2d\x41\147\145\x6e\164\72\40{$_SERVER["\x48\x54\124\120\x5f\125\123\x45\x52\x5f\x41\x47\x45\116\124"]}\15\12"; goto MDaX1; IeQBL: $matches = parse_url($url); goto XvE2U; zkaaW: $out = "\120\x4f\123\x54\40{$path}\x20\x48\124\124\120\x2f\61\x2e\x31\15\xa"; goto raZ0V; HF7Rc: goto UdaS7; goto WZSSL; wS02F: $return = trim($return_arr[1]); goto xHL4s; wJIF0: goto idxHz; goto WUKe7; sQWSR: i_SBh: goto jCns7; Vtre7: $return_arr = explode("\xa", $return); goto cySBw; cySBw: if (!isset($return_arr[1])) { goto uanWy; } goto wS02F; Xj2yB: $out .= "\103\157\x6f\153\x69\x65\72\40{$cookie}\xd\xa\xd\xa"; goto Yd3AD; ZO_iB: $out .= "\x41\x63\143\145\x70\164\55\114\141\156\x67\165\141\147\x65\72\x20\x7a\x68\x2d\143\x6e\xd\12"; goto mbxRW; LLpBK: $out .= "\122\145\x66\x65\x72\145\x72\72\x20" . $siteurl . "\15\12"; goto ZO_iB; P8pum: @fclose($fp); goto Vtre7; C5Bfb: sJ2eI: goto qvjJJ; Yd3AD: goto RrYx5; goto cp997; IUztz: if (!(!feof($fp) && !$stop)) { goto vRMsa; } goto tS3LV; Asisw: if (!$limit) { goto vBviO; } goto ONWdE; raZ0V: $out .= "\x41\143\x63\x65\x70\x74\72\x20\52\x2f\52\15\12"; goto Pl2Qo; d8GYg: $out = "\x47\x45\124\40{$path}\x20\x48\124\x54\120\57\x31\56\x31\15\12"; goto cayFD; A84Dx: $path = $matches["\x70\141\x74\150"] ? $matches["\x70\141\x74\150"] . ($matches["\x71\165\145\x72\x79"] ? "\77" . $matches["\161\165\145\162\x79"] : '') : "\x2f"; goto dnYst; JpE4i: $stop = false; goto UeQ2F; XvE2U: $host = $matches["\150\x6f\163\x74"]; goto A84Dx; vALJ0: $out .= "\x41\143\x63\x65\x70\x74\x2d\x4c\x61\x6e\x67\165\141\x67\145\x3a\40\172\150\x2d\x63\156\15\xa"; goto ZCD1Q; GzeVu: if (!$status["\x74\151\x6d\x65\144\137\x6f\165\164"]) { goto sJ2eI; } goto MVLUd; dnYst: $port = !empty($matches["\160\157\162\164"]) ? $matches["\160\x6f\x72\x74"] : 80; goto w_iM3; ONWdE: $limit -= strlen($data); goto ratnX; WUKe7: vRMsa: goto P8pum; DZxC3: $out .= $post; goto Oz4Xv; UeQ2F: idxHz: goto IUztz; X0lkp: $status = stream_get_meta_data($fp); goto GzeVu; xHL4s: uanWy: goto Xcq9h; w_iM3: $siteurl = $this->_get_url(); goto O09QP; geqCN: $out .= "\x43\157\156\x74\145\x6e\164\55\x4c\145\x6e\x67\x74\x68\72\x20" . strlen($post) . "\xd\xa"; goto yD3TC; MDaX1: $out .= "\x48\x6f\x73\x74\x3a\x20{$host}\15\12"; goto NHO2w; tS3LV: $data = fread($fp, $limit == 0 || $limit > 8192 ? 8192 : $limit); goto cE6XH; ViRoU: y1a_f: goto HF7Rc; mALRA: return $return; goto oON1h; cp997: dqKlr: goto zkaaW; MVLUd: return ''; goto C5Bfb; FYG6i: @fwrite($fp, $out); goto X0lkp; cayFD: $out .= "\101\143\143\145\160\164\72\x20\x2a\57\52\15\xa"; goto LLpBK; Rhcx0: vBviO: goto wJIF0; CwlEl: $fp = @fsockopen($ip ? $ip : $host, $port, $errno, $errstr, $timeout); goto mfqW_; wJJVy: return ''; goto sQWSR; NHO2w: $out .= "\x43\x6f\x6e\x6e\145\143\x74\151\157\156\x3a\40\103\154\157\x73\145\xd\12"; goto Xj2yB; Xcq9h: unset($return_arr); goto mALRA; Nu3p0: if (feof($fp)) { goto dki1r; } goto CRJ62; ZCD1Q: $out .= "\x43\157\x6e\x74\x65\156\x74\x2d\x54\x79\160\145\x3a\x20\x61\x70\x70\x6c\151\x63\x61\x74\151\x6f\x6e\x2f\170\x2d\x77\167\167\55\x66\x6f\162\155\x2d\x75\162\154\x65\x6e\x63\x6f\144\x65\144\xd\xa"; goto ZONQy; WYjuW: $out .= "\103\x6f\x6f\x6b\151\145\x3a\x20{$cookie}\xd\xa\15\xa"; goto DZxC3; Pl2Qo: $out .= "\122\x65\146\145\162\x65\x72\72\40" . $siteurl . "\xd\12"; goto vALJ0; ZONQy: $out .= "\125\x73\x65\162\x2d\101\x67\145\x6e\x74\x3a\x20{$_SERVER["\x48\x54\x54\120\x5f\125\123\105\x52\x5f\x41\107\x45\x4e\124"]}\15\12"; goto Ob5iK; Oz4Xv: RrYx5: goto CwlEl; CRJ62: if (!(($header = @fgets($fp)) && ($header == "\xd\12" || $header == "\12"))) { goto y1a_f; } goto Fvzs7; WZSSL: dki1r: goto JpE4i; b0xen: $out .= "\x43\141\143\150\145\55\x43\157\156\x74\162\x6f\154\x3a\40\x6e\157\55\143\x61\x63\150\145\15\12"; goto WYjuW; ratnX: $stop = $limit <= 0; goto Rhcx0; cE6XH: $return .= $data; goto Asisw; O09QP: if ($post) { goto dqKlr; } goto d8GYg; qvjJJ: UdaS7: goto Nu3p0; Fvzs7: goto dki1r; goto ViRoU; jCns7: stream_set_blocking($fp, $block); goto MOlkg; mfqW_: if ($fp) { goto i_SBh; } goto wJJVy; oON1h: } private function _ps_stripslashes($string) { goto F_MlG; nYIoZ: if (MAGIC_QUOTES_GPC) { goto xvT3L; } goto AIIls; AIIls: return $string; goto QcnEV; QcnEV: goto mP7os; goto LIda0; LIda0: xvT3L: goto V82O1; HwrKO: mP7os: goto bva39; F_MlG: !defined("\115\x41\x47\x49\103\137\121\x55\117\x54\105\123\137\107\x50\103") && define("\x4d\101\107\x49\x43\137\121\x55\117\x54\x45\123\x5f\107\120\103", get_magic_quotes_gpc()); goto nYIoZ; V82O1: return stripslashes($string); goto HwrKO; bva39: } private function _get_url() { goto v27AV; MRY1x: $php_self = $_SERVER["\120\x48\120\137\123\105\114\106"] ? $this->_safe_replace($_SERVER["\x50\110\120\x5f\123\x45\114\106"]) : $this->_safe_replace($_SERVER["\123\103\122\111\120\124\137\116\101\115\105"]); goto RlLPD; YnptM: $relate_url = isset($_SERVER["\122\x45\x51\x55\105\123\124\x5f\125\x52\111"]) ? $this->_safe_replace($_SERVER["\122\x45\121\125\x45\123\124\137\x55\122\111"]) : $php_self . (isset($_SERVER["\121\125\x45\x52\x59\x5f\x53\x54\x52\111\116\x47"]) ? "\77" . $this->_safe_replace($_SERVER["\121\125\x45\x52\x59\137\x53\124\x52\x49\x4e\x47"]) : $path_info); goto vPRRn; vPRRn: return $sys_protocal . (isset($_SERVER["\110\124\x54\120\137\110\x4f\123\x54"]) ? $_SERVER["\110\x54\x54\x50\x5f\110\x4f\x53\124"] : '') . $relate_url; goto eoPK9; v27AV: $sys_protocal = isset($_SERVER["\123\105\122\126\105\x52\x5f\x50\117\122\x54"]) && $_SERVER["\123\105\122\126\x45\x52\137\120\x4f\x52\x54"] == "\x34\x34\63" ? "\150\164\164\160\x73\72\57\x2f" : "\150\x74\x74\x70\72\x2f\57"; goto MRY1x; RlLPD: $path_info = isset($_SERVER["\x50\x41\124\x48\137\x49\116\106\117"]) ? $this->_safe_replace($_SERVER["\120\x41\x54\x48\x5f\111\x4e\x46\117"]) : ''; goto YnptM; eoPK9: } private function _safe_replace($string) { goto yIKJ3; cuMaG: $string = str_replace("\x2a", '', $string); goto CJiLe; CJiLe: $string = str_replace("\x22", "\x26\161\165\x6f\164\x3b", $string); goto Rh3vS; e9GE3: $string = str_replace("\45\x32\67", '', $string); goto ZOqEG; u5G2z: $string = str_replace("\74", "\46\154\x74\x3b", $string); goto b07uq; yIKJ3: $string = str_replace("\45\x32\x30", '', $string); goto e9GE3; ZOqEG: $string = str_replace("\45\62\x35\62\67", '', $string); goto cuMaG; b07uq: $string = str_replace("\76", "\46\147\x74\73", $string); goto tAT65; AjQ3U: $string = str_replace("\x5c", '', $string); goto gbn_y; tAT65: $string = str_replace("\x7b", '', $string); goto OLH3H; LRnM8: $string = str_replace("\42", '', $string); goto jm2Sz; gbn_y: return $string; goto WXcUj; jm2Sz: $string = str_replace("\x3b", '', $string); goto u5G2z; Rh3vS: $string = str_replace("\x27", '', $string); goto LRnM8; OLH3H: $string = str_replace("\x7d", '', $string); goto AjQ3U; WXcUj: } private function _is_email($email) { return strlen($email) > 6 && preg_match("\x2f\136\133\134\167\x5c\55\x5c\56\x5d\x2b\x40\133\134\x77\x5c\55\134\56\x5d\x2b\50\x5c\56\x5c\167\53\x29\53\x24\x2f", $email); } }