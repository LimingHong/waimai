<?php
 class MihuaToken { const API_URL = "\150\164\x74\x70\72\x2f\x2f\x61\x70\x69\56\x73\172\x6d\151\150\x75\141\56\x63\x6f\x6d"; public static function getToken($appId, $appSecretKey, $refesh = 0) { return self::getTokenFromRemote($appId, $appSecretKey); } private static function getTokenFromRemote($appId, $appSecretKey) { goto ByJZ8; MenhV: $params = ["\141\160\160\x5f\x69\144" => $appId, "\162\141\156\x64\137\x73\164\162" => $randStr, "\163\151\x67\156" => $sing]; goto eBIre; xRWji: $status = $result->getStatusCode(); goto YpMNq; eBIre: $result = $client->get("\x2f\141\x75\x74\x68", ["\161\x75\x65\162\x79" => $params]); goto xRWji; FVAQK: if (!($content["\143\x6f\144\x65"] != 0)) { goto fmccs; } goto ugghK; um2Yb: fmccs: goto NhJDM; ANqZH: self::saveToken($token); goto EpmYn; vZPW2: $sing = "\141\x70\160\x5f\x69\144\x3d" . $appId . "\x61\160\x70\x5f\x73\145\x63\x72\x65\x74\137\x6b\x65\171\x3d" . $appSecretKey . "\162\141\x6e\x64\x5f\x73\164\162\x3d" . $randStr; goto Wr8yN; L03Im: $content = $result->getBody()->getContents(); goto b28s2; ByJZ8: $apiDomain = self::API_URL; goto oTgw0; b28s2: if ($content) { goto X84T_; } goto ewTv3; ewTv3: throw new LogicException("\xe8\257\267\xe6\261\x82\xe5\244\261\350\264\245"); goto v5zDD; ugghK: throw new LogicException($content["\155\x73\147"], $content["\143\157\x64\145"]); goto um2Yb; EpmYn: return $token; goto kkZhA; NhJDM: $token = $content["\144\x61\x74\141"]; goto ANqZH; KHAUB: $content = json_decode($content, 1); goto FVAQK; sg3HS: throw new LogicException("\350\xaf\267\xe6\xb1\202\351\224\x99\350\257\257"); goto omzjd; Wr8yN: $sing = md5($sing); goto MenhV; oTgw0: $client = new \GuzzleHttp\Client(["\x62\x61\x73\145\x5f\165\162\151" => $apiDomain, "\x74\151\x6d\145\x6f\165\164" => 5]); goto mckmT; YpMNq: if (!($status != 200)) { goto o0hgA; } goto sg3HS; mckmT: $randStr = time(); goto vZPW2; omzjd: o0hgA: goto L03Im; v5zDD: X84T_: goto KHAUB; kkZhA: } private static function saveToken($token) { $_SESSION["\x6d\151\x68\165\x61\137\164\157\x6b\145\156"] = $token; } private static function getCacheToken() { goto JE7Ny; uos7p: igSYB: goto jKdfA; NEYKO: return $_SESSION["\x6d\x69\150\x75\x61\x5f\x74\157\x6b\145\156"]; goto uos7p; jKdfA: return ''; goto vTnDf; JE7Ny: if (!isset($_SESSION["\x6d\x69\x68\165\141\x5f\x74\x6f\153\x65\156"])) { goto igSYB; } goto NEYKO; vTnDf: } }