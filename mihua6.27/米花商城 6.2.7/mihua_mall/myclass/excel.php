<?php
 goto a8AgD; uD37P: if (defined("\x49\116\137\x49\101")) { goto WzeIg; } goto Ol_tf; w9WZH: if (class_exists("\x45\x78\x63\x65\154\115\157\x64\145\154")) { goto UMwdx; } goto SGeuP; SGeuP: class ExcelModel { protected function column_str($key) { $array = array("\x41", "\x42", "\103", "\x44", "\105", "\106", "\x47", "\x48", "\x49", "\x4a", "\x4b", "\x4c", "\115", "\x4e", "\x4f", "\120", "\x51", "\x52", "\x53", "\124", "\125", "\126", "\x57", "\x58", "\131", "\x5a", "\101\x41", "\x41\102", "\x41\103", "\101\x44", "\101\x45", "\101\x46", "\101\x47", "\x41\x48", "\x41\x49", "\x41\x4a", "\101\113", "\x41\x4c", "\101\x4d", "\x41\x4e", "\101\117", "\x41\120", "\101\x51", "\x41\122", "\x41\x53", "\x41\124", "\x41\x55", "\101\x56", "\x41\x57", "\x41\x58", "\101\131", "\101\x5a", "\x42\101", "\102\102", "\x42\103", "\x42\104", "\x42\x45", "\x42\106", "\102\x47", "\x42\110", "\102\111", "\x42\112", "\102\x4b", "\x42\x4c", "\x42\x4d", "\x42\116", "\102\117", "\102\x50", "\102\121", "\102\x52", "\x42\x53", "\x42\x54", "\x42\125", "\102\126", "\x42\x57", "\102\x58", "\102\x59", "\102\132", "\103\101", "\103\x42", "\x43\x43", "\103\x44", "\103\x45", "\103\x46", "\103\x47", "\x43\110", "\103\x49", "\103\112", "\103\113", "\x43\x4c", "\x43\115", "\103\116", "\103\117", "\103\120", "\103\x51", "\103\x52", "\x43\123", "\x43\124", "\103\125", "\103\x56", "\x43\127", "\103\x58", "\103\x59", "\x43\132", "\104\x41", "\104\x42", "\104\x43", "\x44\x44", "\x44\x45", "\104\x46", "\104\x47", "\x44\x48", "\x44\x49", "\104\112", "\104\113", "\104\114", "\x44\115", "\104\x4e", "\104\117", "\x44\x50", "\x44\121", "\x44\x52", "\x44\123", "\104\124", "\x44\125", "\104\126", "\x44\x57", "\x44\130", "\x44\131", "\x44\x5a", "\x45\101", "\105\x42", "\x45\x43", "\x45\x44", "\105\x45", "\105\x46", "\x45\x47", "\x45\x48", "\x45\111", "\105\112", "\x45\x4b", "\x45\114", "\105\115", "\x45\x4e", "\105\117", "\x45\x50", "\x45\x51", "\x45\122", "\105\123", "\105\124", "\x45\x55", "\105\126", "\105\127", "\x45\x58", "\x45\131", "\x45\x5a"); return $array[$key]; } protected function column($key, $columnnum = 1) { return $this->column_str($key) . $columnnum; } function export($list, $params = array()) { goto JuyGK; VPKdv: readfile($filePath); goto X4Sbt; EYd0_: $rownum = 1; goto s6Thl; vseDJ: $excel->getActiveSheet()->setTitle($params["\x74\151\x74\x6c\145"]); goto lFOGL; X4Sbt: unlink($filePath); goto BqIAD; JevVW: $writer->save($filePath); goto VPKdv; gAL7o: J3nFV: goto zMW9w; dRYn5: header("\103\157\x6e\x74\145\x6e\x74\55\104\x69\x73\x70\x6f\163\x69\164\151\x6f\x6e\72\x20\x61\164\164\141\143\150\x6d\x65\156\164\x3b\146\x69\x6c\x65\156\x61\155\145\75\x22" . $filename . "\56\x78\154\x73\42"); goto hA44c; AeuYl: foreach ($list as $row) { goto DdSDL; vnDfi: $i++; goto EuEmL; YgRDL: nhRdv: goto dHeQs; oLdjY: $sheet->setCellValue($this->column($i, $rownum), $value); goto Q3XeL; dHeQs: $rownum++; goto hQldZ; EuEmL: goto UwzTL; goto YgRDL; hQldZ: HiW8S: goto M8Wdu; Kjto4: UwzTL: goto cayUe; mpYRX: $value = isset($row[$params["\143\x6f\154\x75\x6d\156\x73"][$i]["\146\x69\145\x6c\144"]]) ? $row[$params["\143\157\154\x75\155\156\x73"][$i]["\x66\x69\x65\154\144"]] : ''; goto oLdjY; cayUe: if (!($i < $len)) { goto nhRdv; } goto mpYRX; Q3XeL: mN9Z8: goto vnDfi; DdSDL: $i = 0; goto Kjto4; M8Wdu: } goto aYbf7; wLDbn: $writer = PHPExcel_IOFactory::createWriter($excel, "\x45\170\143\145\154\x35"); goto yITmd; JuyGK: if (!(PHP_SAPI == "\143\154\151")) { goto v31Yq; } goto V2QJ2; EyreO: $len = count($params["\x63\x6f\x6c\165\155\x6e\163"]); goto AeuYl; zMW9w: $rownum++; goto EyreO; Pfj8n: $sheet = $excel->setActiveSheetIndex(0); goto EYd0_; V2QJ2: die("\124\x68\151\163\x20\x65\170\141\x6d\160\x6c\145\x20\163\x68\x6f\165\154\x64\x20\157\x6e\x6c\x79\40\142\x65\x20\x72\165\156\x20\146\x72\x6f\x6d\x20\x61\x20\x57\145\142\x20\x42\x72\157\167\163\145\x72"); goto tbC03; tbC03: v31Yq: goto TwfV6; lFOGL: $filename = urlencode($params["\x74\151\164\154\145"] . "\55" . date("\131\x2d\155\55\x64\x20\110\72\x69", time())); goto iN10L; LbSMm: $excel = new PHPExcel(); goto PoBCl; aYbf7: UFjlu: goto vseDJ; PdT17: header("\x43\157\156\164\145\x6e\x74\x2d\124\171\160\x65\72\x20\x61\160\160\154\x69\143\141\x74\x69\157\156\57\157\x63\x74\145\x74\x2d\163\x74\162\145\141\155"); goto dRYn5; yITmd: $filePath = dirname(__FILE__) . rand(0, getrandmax()) . rand(0, getrandmax()) . "\56\164\155\160"; goto JevVW; PoBCl: $excel->getProperties()->setCreator("\345\225\x86\345\237\x8e")->setLastModifiedBy("\xe5\x95\206\345\237\x8e")->setTitle("\117\146\x66\151\x63\145\x20\x32\x30\60\x37\40\x58\x4c\123\130\x20\124\145\x73\164\x20\104\157\143\x75\x6d\x65\156\164")->setSubject("\117\146\x66\x69\143\145\40\x32\60\60\x37\x20\130\x4c\123\130\40\124\x65\x73\x74\x20\104\x6f\x63\x75\155\145\156\164")->setDescription("\x54\145\x73\x74\x20\144\x6f\x63\x75\155\x65\156\164\40\x66\x6f\x72\40\117\x66\146\x69\143\x65\40\62\x30\60\x37\x20\x58\114\x53\x58\x2c\40\x67\145\156\x65\162\141\164\145\144\40\x75\163\151\156\x67\40\x50\110\x50\x20\x63\x6c\x61\163\x73\x65\x73\56")->setKeywords("\x6f\146\x66\x69\143\145\40\x32\x30\60\67\40\157\160\x65\156\170\155\x6c\x20\x70\x68\160")->setCategory("\162\x65\160\157\162\x74\40\146\x69\154\x65"); goto Pfj8n; s6Thl: foreach ($params["\x63\x6f\154\165\x6d\156\x73"] as $key => $column) { goto jdmLY; vgCGk: $sheet->getColumnDimension($this->column_str($key))->setWidth($column["\x77\151\144\164\x68"]); goto rpX0O; jdmLY: $sheet->setCellValue($this->column($key, $rownum), $column["\x74\151\x74\154\x65"]); goto lwvep; lwvep: if (empty($column["\x77\151\x64\164\x68"])) { goto AVXLb; } goto vgCGk; rpX0O: AVXLb: goto Y6CVb; Y6CVb: bD0xS: goto zk051; zk051: } goto gAL7o; TwfV6: require_once IA_ROOT . "\57\146\x72\x61\x6d\145\167\157\x72\x6b\57\154\151\x62\162\x61\x72\x79\57\x70\x68\x70\x65\x78\x63\x65\154\57\120\110\x50\x45\x78\143\x65\154\56\160\x68\160"; goto LbSMm; BqIAD: exit; goto y6nQK; hA44c: header("\103\141\143\150\x65\55\103\x6f\x6e\164\x72\x6f\154\72\40\155\x61\x78\x2d\x61\x67\x65\75\60"); goto wLDbn; iN10L: ob_end_clean(); goto PdT17; y6nQK: } public function import($excefile) { goto LQFCp; SGauL: $row = 2; goto mxvYf; NZL8k: $col++; goto GDOIT; eHnN3: die("\350\257\267\xe4\xb8\212\xe4\274\240\x20\x78\154\x73\xe6\240\xbc\xe5\274\x8f\xe7\232\x84\105\x78\x63\145\154\xe6\226\x87\344\273\xb6\x21"); goto Vn6kM; NIXTR: $reader = PHPExcel_IOFactory::createReader("\x45\x78\x63\x65\x6c\65"); goto xrUUR; OTSom: die("\344\xb8\212\xe4\274\xa0\x45\x78\143\145\x6c\x20\xe6\226\x87\xe4\273\xb6\xe5\244\261\350\xb4\245\x2c\x20\xe8\257\xb7\351\207\x8d\xe6\x96\260\344\270\212\xe4\274\xa0\41"); goto Lefl0; P9jSh: $filename = $_FILES[$excefile]["\156\x61\155\145"]; goto Sctuj; twatF: $rowValue = array(); goto bIc9m; dde90: AnkhI: goto biWBC; rc42q: require_once IA_ROOT . "\x2f\x66\162\141\155\x65\x77\x6f\162\153\57\154\x69\142\162\141\162\171\57\160\x68\160\x65\170\x63\x65\154\x2f\x50\x48\x50\105\x78\x63\x65\x6c\x2e\160\x68\160"; goto Z8HKh; Sctuj: $tmpname = $_FILES[$excefile]["\164\x6d\160\x5f\156\x61\x6d\x65"]; goto QoRDP; mxvYf: Zw2Rq: goto qYA8A; aHwW2: $uploadfile = $path . $file; goto YFhFi; sNdYX: $highestColumnCount = PHPExcel_Cell::columnIndexFromString($highestColumn); goto H7i20; XQJJL: exit; goto gi1E1; iSf19: $row++; goto YGRLK; QUKuT: $rowValue[] = $sheet->getCellByColumnAndRow($col, $row)->getValue(); goto vCUgL; Gfq08: require_once IA_ROOT . "\x2f\146\162\x61\155\145\x77\157\162\153\x2f\154\x69\x62\162\x61\x72\x79\57\x70\x68\160\145\170\143\145\154\57\120\x48\x50\105\x78\143\x65\x6c\57\x52\x65\x61\x64\x65\x72\x2f\x45\x78\143\145\154\x35\x2e\160\x68\x70"; goto tzVsq; iCxiV: $highestRow = $sheet->getHighestRow(); goto VSwuD; QoRDP: if (!empty($tmpname)) { goto Kddbx; } goto VvGgT; ZRpX6: BBNLC: goto iSf19; GDOIT: goto mBBNP; goto dde90; H7i20: $values = array(); goto SGauL; Vn6kM: exit; goto dvPKj; dvPKj: VKN8a: goto aHwW2; YGRLK: goto Zw2Rq; goto jIm3s; QJGQJ: mBBNP: goto CLpMt; VSwuD: $highestColumn = $sheet->getHighestColumn(); goto sNdYX; xrUUR: $excel = $reader->load($uploadfile); goto Bu0Nh; jIm3s: spJkk: goto pVPnM; nrk7d: MUYkY: goto fKXg5; sbjP4: $ext = strtolower(pathinfo($filename, PATHINFO_EXTENSION)); goto lbJlQ; vCUgL: sYD48: goto NZL8k; Z8HKh: require_once IA_ROOT . "\x2f\x66\x72\x61\x6d\x65\167\x6f\162\153\57\154\151\142\x72\141\162\171\x2f\x70\x68\160\145\x78\x63\x65\x6c\57\x50\110\120\x45\170\143\145\154\57\111\x4f\106\x61\143\x74\157\162\171\x2e\x70\x68\160"; goto Gfq08; LQFCp: global $_W; goto rc42q; Lefl0: exit; goto s0QTj; NUmZT: mkdirs($path, "\60\x37\x37\67"); goto nrk7d; pVPnM: return $values; goto R4GRW; Bu0Nh: $sheet = $excel->getActiveSheet(); goto iCxiV; s0QTj: rzVUT: goto NIXTR; qYA8A: if (!($row <= $highestRow)) { goto spJkk; } goto twatF; VvGgT: die("\xe8\xaf\xb7\xe9\x80\x89\xe6\213\xa9\xe8\xa6\201\344\270\212\344\274\240\347\232\x84\x45\170\143\145\x6c\346\x96\207\344\xbb\xb6\x21"); goto XQJJL; bIc9m: $col = 0; goto QJGQJ; CLpMt: if (!($col < $highestColumnCount)) { goto AnkhI; } goto QUKuT; fKXg5: $file = time() . $_W["\x75\x6e\x69\x61\x63\x69\x64"] . "\56\170\154\x73"; goto P9jSh; biWBC: $values[] = $rowValue; goto ZRpX6; XZm9c: if ($result) { goto rzVUT; } goto OTSom; lbJlQ: if (!($ext != "\170\x6c\x73")) { goto VKN8a; } goto eHnN3; tzVsq: $path = IA_ROOT . "\57\143\141\x63\150\145\x2f\x64\x61\x74\141\57\164\x6d\x70\57"; goto U1d_U; U1d_U: if (is_dir($path)) { goto MUYkY; } goto NUmZT; YFhFi: $result = move_uploaded_file($tmpname, $uploadfile); goto XZm9c; gi1E1: Kddbx: goto sbjP4; R4GRW: } } goto lEzgU; a8AgD: require_once IA_ROOT . "\57\141\144\x64\157\156\163\57\x6d\x69\x68\165\x61\137\x6d\x61\154\154\x2f\155\x79\x63\x6c\x61\x73\163\x2f\125\x74\x69\154\56\143\154\x61\163\163\56\x70\x68\160"; goto uD37P; Oan3w: WzeIg: goto w9WZH; Ol_tf: exit("\101\x63\x63\145\x73\163\40\x44\145\x6e\151\x65\144"); goto Oan3w; lEzgU: UMwdx: