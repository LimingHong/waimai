<?php
 class Admin { public $group_ids; public function adminLogin($passport, $password) { goto Iwld1; bYD_i: if (function_exists("\x61\165\164\150\143\x6f\x64\145")) { goto f76PA; } goto AOkEH; mAmKv: if (!empty($username)) { goto HDX1R; } goto FPw4x; eDolg: if (empty($failed)) { goto owyqk; } goto rupcU; MvdLa: $member["\x75\x73\145\162\156\x61\x6d\145"] = $username; goto xDbVW; tDzF_: tLOuq: goto N0WIx; hkSr6: f76PA: goto lV7tZ; d0cCe: $status["\154\141\x73\x74\x69\x70"] = CLIENT_IP; goto HgYvf; CEPdo: nRAlN: goto syYP8; YXhve: if (!(!empty($record["\x65\x6e\144\164\x69\x6d\x65"]) && $record["\145\156\x64\164\151\155\x65"] < TIMESTAMP)) { goto nRAlN; } goto GtBDt; hcYrS: x9VfW: goto Sbc_H; U4fcs: $status["\165\x69\144"] = $record["\165\x69\144"]; goto u_imR; NHLqy: m3I2x: goto XN38e; dCinX: juCRl: goto mAmKv; XN38e: $cookie = array(); goto UybBa; ZeRzt: $founders = explode("\54", $_W["\143\x6f\156\x66\151\147"]["\163\145\164\164\151\x6e\x67"]["\146\157\165\x6e\x64\145\162"]); goto cU2nW; IHWy0: pdo_query("\104\x45\x4c\105\x54\105\x20\x46\122\117\115\x20" . tablename("\x75\x73\x65\162\163\x5f\x66\x61\151\154\145\144\x5f\x6c\x6f\x67\151\x6e") . "\x20\127\110\x45\x52\105\40\154\x61\x73\x74\165\160\144\x61\x74\x65\40\x3c\x20\x3a\x74\151\x6d\145\x73\x74\141\x6d\160", array("\72\x74\151\x6d\x65\x73\x74\141\x6d\160" => TIMESTAMP - 300)); goto xOUIO; AoIml: if (!($failed["\x63\157\x75\x6e\x74"] >= 5)) { goto juCRl; } goto Dw80O; WMHA7: isetcookie("\137\x5f\165\x6e\151\x61\143\x69\144", '', -7 * 86400); goto TTCjb; L1bmb: $founders = explode("\x2c", $_W["\x63\x6f\156\146\151\x67"]["\x73\x65\164\x74\x69\156\147"]["\146\x6f\165\156\x64\145\162"]); goto ZeRzt; HgYvf: user_update($status); goto aEqHf; DQXls: NyQzU: goto L1bmb; kwY6l: $cookie["\x68\x61\x73\150"] = md5($record["\x70\x61\163\x73\167\x6f\162\x64"] . $record["\x73\141\154\164"]); goto g_Z33; lV7tZ: $session = authcode(json_encode($cookie), "\x65\x6e\143\x6f\x64\145"); goto tDzF_; MMf1B: ymuPw: goto QvWGG; TTCjb: isetcookie("\137\137\165\x69\x64", '', -7 * 86400); goto zSM1f; N0WIx: isetcookie("\x5f\137\163\145\163\x73\x69\x6f\156", $session, !empty($_GPC["\x72\145\x6d\142\x65\162"]) ? 7 * 86400 : 0, true); goto t9hIl; UybBa: $record = $wq_record; goto A9rnt; hiCOi: $username = trim($passport); goto IHWy0; zSM1f: kuoVy: goto mB6Qq; WKhF5: goto tLOuq; goto hkSr6; aEqHf: isetcookie("\137\x5f\165\x6e\151\x61\x63\x69\x64", $record["\165\x6e\151\141\x63\x69\144"], 7 * 86400); goto uX21i; AL0t6: pdo_insert("\165\163\145\x72\x73\137\146\141\x69\x6c\145\144\137\154\157\x67\151\156", array("\151\160" => CLIENT_IP, "\165\163\x65\162\x6e\141\155\x65" => $username, "\x63\x6f\x75\156\x74" => "\61", "\154\x61\163\x74\165\x70\144\x61\164\145" => TIMESTAMP)); goto N6iev; Md8h_: pdo_delete("\165\x73\145\162\163\x5f\146\x61\151\x6c\x65\x64\x5f\x6c\x6f\x67\x69\156", array("\151\144" => $failed["\151\x64"])); goto Eg2E5; n5ym7: return array("\145\162\162\x63\x6f\x64\x65" => 1, "\155\163\147" => "\346\x82\250\347\232\x84\350\264\xa6\345\x8f\xb7\xe6\xad\243\345\x9c\250\345\xae\xa1\xe6\xa0\270\346\210\226\346\x98\257\345\xb7\xb2\347\273\x8f\xe8\xa2\xab\347\xb3\xbb\xe7\273\237\xe7\xa6\201\xe6\xad\242\357\xbc\x8c\xe8\257\267\350\x81\224\347\xb3\xbb\347\256\241\xe7\x90\206\xe5\x91\x98\xe8\xa7\xa3\345\x86\xb3\357\274\201"); goto E43Yh; I40NK: setWebLogin($list[0]["\165\156\151\x61\143\151\x64"], $record["\165\x69\144"]); goto Md8h_; jbsA1: if (!empty($_W["\x69\163\x66\x6f\165\156\144\x65\162"])) { goto jgSXn; } goto YXhve; PAeuu: if (!($wq_record["\163\164\141\x74\x75\x73"] == 1 && $wq_record)) { goto NyQzU; } goto WtpCd; mB6Qq: $list = $this->getAllPlatform(); goto I40NK; O15bi: if ($wq_record) { goto x9VfW; } goto eDolg; g_Z33: if (str_replace("\x2e", '', IMS_VERSION) < 144 || !function_exists("\x61\x75\x74\150\143\157\x64\x65")) { goto P0EIk; } goto bYD_i; E43Yh: yV1q1: goto PAeuu; c7Q0w: if (!(!empty($_W["\x73\151\x74\145\x63\154\157\163\145"]) && empty($_W["\x69\x73\146\157\165\x6e\x64\x65\x72"]))) { goto m3I2x; } goto uQS7w; cU2nW: $_W["\151\x73\x66\x6f\165\156\x64\145\162"] = in_array($record["\165\x69\144"], $founders); goto jbsA1; kYyZ8: owyqk: goto AL0t6; uX21i: isetcookie("\137\x5f\165\151\144", $record["\165\x69\x64"], 7 * 86400); goto n6cxk; Dw80O: return array("\x65\x72\x72\x63\x6f\144\x65" => 1, "\155\163\147" => "\xe8\276\x93\xe5\205\xa5\xe5\257\206\xe7\xa0\201\xe9\x94\231\350\257\257\xe6\254\241\xe6\225\xb0\xe8\xb6\x85\xe8\xbf\x87\65\xe6\xac\xa1\357\274\x8c\xe8\257\xb7\xe5\234\xa8\x35\345\210\206\xe9\222\237\345\x90\216\345\x86\215\347\x99\273\xe5\275\x95"); goto dCinX; Sbc_H: if (!($record["\141\144\x6d\151\156\x5f\163\x74\141\164\165\163"] == 0 && $record)) { goto yV1q1; } goto n5ym7; Dm4Pe: return array("\x65\162\162\143\x6f\x64\x65" => 1, "\155\x73\147" => "\xe7\231\273\xe5\xbd\x95\xe5\244\xb1\xe8\xb4\xa5\xef\274\x8c\xe8\257\267\346\243\200\346\x9f\245\346\x82\xa8\xe8\276\x93\345\205\xa5\xe7\232\x84\xe7\x94\xa8\xe6\x88\xb7\345\220\215\345\x92\214\xe5\xaf\206\347\240\x81\xef\274\201"); goto HxxiK; pZlBh: $session = base64_encode(json_encode($cookie)); goto WKhF5; xDbVW: $member["\160\x61\x73\x73\167\x6f\x72\x64"] = $password; goto p7hbX; HxxiK: goto ymuPw; goto hcYrS; cIXV8: goto OHBsl; goto kYyZ8; RUU6f: $cookie["\154\x61\x73\x74\151\160"] = $record["\154\141\163\x74\x69\160"]; goto kwY6l; WtpCd: return array("\x65\x72\162\143\x6f\x64\x65" => 1, "\155\163\147" => "\xe6\202\xa8\347\232\204\xe8\264\xa6\345\x8f\267\xe6\255\243\345\234\xa8\xe5\256\xa1\xe6\xa0\xb8\xe6\x88\226\xe6\230\257\345\267\262\xe7\273\x8f\xe8\242\xab\xe7\xb3\273\347\xbb\x9f\347\xa6\201\346\255\xa2\xef\xbc\x8c\xe8\257\xb7\350\201\x94\347\xb3\xbb\347\256\241\347\x90\206\xe5\221\x98\350\xa7\243\345\x86\263\xef\274\201"); goto DQXls; t9hIl: $status = array(); goto U4fcs; GtBDt: message("\346\x82\xa8\xe7\x9a\x84\350\264\xa6\345\217\267\346\234\x89\346\x95\x88\346\234\237\351\231\220\345\267\262\xe8\277\x87\xef\xbc\x8c\xe8\xaf\xb7\xe8\x81\224\347\xb3\xbb\347\xbd\x91\347\253\x99\347\xae\xa1\347\220\x86\xe5\221\230\xe8\xa7\xa3\345\x86\263\357\xbc\201"); goto CEPdo; uQS7w: message("\xe7\xab\231\347\x82\271\345\xb7\262\345\205\xb3\351\227\255\xef\xbc\x8c\xe5\205\xb3\xe9\x97\xad\xe5\x8e\237\345\x9b\xa0\357\274\x9a" . $_W["\x73\x65\x74\164\x69\156\x67"]["\x63\x6f\160\x79\162\151\x67\x68\x74"]["\162\x65\141\163\x6f\156"]); goto NHLqy; FPw4x: return array("\145\162\x72\143\157\144\x65" => 1, "\155\x73\147" => "\xe8\257\xb7\xe8\xbe\223\xe5\x85\245\350\xa6\x81\xe7\231\273\345\xbd\x95\xe7\232\x84\347\224\250\346\210\267\345\x90\x8d"); goto J8ubn; p7hbX: if (!empty($member["\x70\141\163\x73\x77\x6f\x72\144"])) { goto KMjUF; } goto fcYmT; syYP8: jgSXn: goto c7Q0w; J8ubn: HDX1R: goto MvdLa; Iwld1: global $_GPC, $_W; goto hiCOi; Eg2E5: return array("\x65\162\162\143\157\x64\145" => 0, "\155\x73\147" => "\x73\x75\x63\x63\145\x73\163", "\x75\x69\x64" => $record["\165\151\144"]); goto MMf1B; XN7yP: $wq_record = user_single($member); goto O15bi; fcYmT: return array("\145\x72\162\143\x6f\x64\145" => 1, "\155\163\147" => "\350\257\xb7\xe8\xbe\223\345\x85\245\345\257\x86\347\xa0\201"); goto IytNU; xOUIO: $failed = pdo_get("\x75\163\x65\162\163\137\x66\141\151\154\x65\x64\x5f\x6c\157\x67\151\156", array("\x75\163\x65\x72\x6e\141\x6d\145" => $username, "\151\160" => CLIENT_IP)); goto AoIml; l86Qe: P0EIk: goto pZlBh; rupcU: pdo_update("\165\x73\x65\x72\x73\x5f\x66\x61\151\x6c\x65\144\x5f\154\x6f\147\151\x6e", array("\x63\x6f\165\x6e\x74" => $failed["\x63\157\165\x6e\164"] + 1, "\154\141\x73\164\165\x70\x64\141\x74\x65" => TIMESTAMP), array("\151\144" => $failed["\151\x64"])); goto cIXV8; AIjsH: $cookie["\x6c\x61\x73\164\166\x69\x73\x69\164"] = $record["\154\141\x73\x74\x76\x69\163\151\x74"]; goto RUU6f; IytNU: KMjUF: goto XN7yP; u_imR: $status["\x6c\x61\x73\x74\166\x69\x73\151\164"] = TIMESTAMP; goto d0cCe; AOkEH: goto tLOuq; goto l86Qe; n6cxk: if (!($record["\165\x69\x64"] != $_GPC["\x5f\137\x75\x69\x64"])) { goto kuoVy; } goto WMHA7; N6iev: OHBsl: goto Dm4Pe; A9rnt: $cookie["\x75\x69\144"] = $record["\165\151\x64"]; goto AIjsH; QvWGG: } public function getGroup() { goto Q3hj3; Q3hj3: $list = pdo_fetchall("\x73\x65\154\x65\143\164\40\x2a\x20\x66\162\157\x6d\x20\40" . tablename("\165\156\151\137\147\x72\x6f\x75\x70") . "\x20"); goto QJLCF; fqwlZ: return $group_ids; goto qkfIi; bt33p: foreach ($list as $row) { goto pxLPW; YPYx3: bTs0z: goto PpX_X; sRAkv: UI2Cb: goto xEVIV; Ic5w4: if (!$modules) { goto L9ZJJ; } goto wWMmB; pxLPW: $modules = unserialize($row["\x6d\157\144\x75\x6c\145\x73"]); goto Ic5w4; wWMmB: foreach ($modules as $value) { goto vbBm0; vbBm0: if (!($value == "\x6d\x69\150\165\141\x5f\x6d\x61\x6c\x6c")) { goto I2amy; } goto cOqC3; PxLgq: qOyur: goto GEsia; cOqC3: $group_ids[] = $row["\x69\144"]; goto OZ6Kv; LtTaK: I2amy: goto PxLgq; OZ6Kv: goto UI2Cb; goto LtTaK; GEsia: } goto sRAkv; xEVIV: L9ZJJ: goto YPYx3; PpX_X: } goto HjCbh; QJLCF: $group_ids[] = "\x2d\x31"; goto bt33p; HjCbh: kgjuH: goto xy1Xh; xy1Xh: $this->group_ids = $group_ids; goto fqwlZ; qkfIi: } public function validPlatform($uniacid) { goto xbVas; T5zV2: XYzec: goto fqYX4; fqYX4: $in_str = implode("\x2c", $this->group_ids); goto xZTA1; v80gJ: return $result; goto Xfy_R; xbVas: if ($this->group_ids) { goto XYzec; } goto YRsUY; xZTA1: $result = pdo_fetch("\163\145\x6c\x65\x63\x74\x20\x2a\40\146\x72\x6f\x6d\40" . tablename("\x75\156\x69\x5f\141\x63\x63\157\x75\156\164\137\147\162\x6f\x75\x70") . "\40\x77\150\145\x72\x65\x20\40\165\x6e\x69\141\x63\151\x64\x20\75\40" . $uniacid . "\40\141\156\x64\40\147\x72\x6f\165\x70\151\144\x20\151\156\40\50" . $in_str . "\x29\40"); goto v80gJ; YRsUY: $this->getGroup(); goto T5zV2; Xfy_R: } public function getAdminInfo($admin_id) { goto j1IJ1; bOKN5: return $re; goto IB9N0; Qz260: $params["\72\141\144\155\151\x6e\137\x69\x64"] = $admin_id; goto GVIgZ; GVIgZ: $re = pdo_fetch("\163\145\x6c\145\x63\x74\x20\52\40\x66\x72\157\155\x20\x20" . tablename("\x75\163\145\x72\163") . "\x20\167\x68\145\162\145\40" . $where, $params); goto bOKN5; j1IJ1: $where = "\40\165\x69\x64\x3d\x3a\141\144\155\151\156\137\151\144"; goto Qz260; IB9N0: } public function judeAdminType($uid = false) { goto l0aGN; yOief: $jia_admin = false; goto cCJdc; bBql1: setDbAdmin(0); goto Br3QN; FVqXg: if ($jia_admin) { goto aqfCI; } goto bBql1; klYXa: $jia_admin = true; goto ECxoV; wjOsF: goto o3IDL; goto R3dUL; l0aGN: global $_W, $_GPC; goto klYXa; cCJdc: $out = array("\x61\x64\x6d\x69\156" => "\164\x6f\160", "\151\163\x66\x6f\x75\x6e\144\x65\162" => 1); goto iyOhW; sUkW_: aqfCI: goto f089e; f089e: return $out; goto gxKVb; Br3QN: setTeacherAdmin(0); goto sUkW_; mA18q: if ($_W["\x69\x73\146\x6f\165\156\x64\x65\162"]) { goto RfAgs; } goto ORDlT; ECxoV: if ($uid) { goto lrE5h; } goto sPWTN; R3dUL: RfAgs: goto yOief; iyOhW: o3IDL: goto FVqXg; J6pSB: lrE5h: goto RM7tP; sPWTN: $uid = $_W["\x75\x69\x64"]; goto J6pSB; Wye4J: $result = $this->getAdminInfo($admin_id); goto wjOsF; RM7tP: $user_info = user_single($uid); goto mA18q; ORDlT: $admin_id = $_GPC["\x5f\141\x64\155\x69\156\137\151\x64"]; goto Wye4J; gxKVb: } public function getAllPlatform() { goto z95hJ; Hnkmw: $list = pdo_fetchall($sql, $pars); goto twbKx; twbKx: if (empty($list)) { goto zFjb7; } goto Yh41E; B4kbh: return $list; goto j2PN4; z95hJ: $sql = "\123\105\114\105\x43\124\40\x2a\x20\x46\x52\x4f\x4d\x20" . tablename("\165\x6e\x69\x5f\x61\x63\x63\157\165\156\x74") . "\40\x61\163\x20\141\40\114\105\106\x54\40\112\x4f\x49\116" . tablename("\x61\x63\x63\157\165\156\x74") . "\x20\141\163\40\142\x20\117\x4e\x20\x61\x2e\144\145\146\141\x75\154\164\x5f\141\x63\151\x64\40\75\x20\x62\56\141\143\x69\144\40\x77\x68\145\x72\x65\x20\x62\56\151\163\144\x65\154\145\164\145\x64\40\74\76\x20\61\x20\x6f\x72\x64\x65\162\40\142\171\x20\x61\x2e\140\162\x61\x6e\x6b\140\x20\x44\x45\x53\103\x2c\x20\x61\56\140\165\x6e\x69\x61\143\151\144\140\40\x44\x45\123\103\x20"; goto Hnkmw; iv8jB: WS1v0: goto XCeaZ; Yh41E: foreach ($list as $unia => &$account) { goto GayC_; GayC_: $account["\144\x65\x74\x61\151\x6c\x73"] = uni_accounts($account["\165\x6e\151\141\x63\x69\x64"]); goto QO6dU; sWory: $have_power = true; goto tO9bD; hG6l1: unset($list[$unia]); goto NcWbm; QO6dU: $account["\x73\145\164\155\x65\141\x6c"] = uni_setmeal($account["\165\156\x69\x61\x63\x69\144"]); goto sWory; tO9bD: if ($have_power) { goto ixp0A; } goto hG6l1; Sc8p_: xmFWA: goto fnXx7; NcWbm: ixp0A: goto Sc8p_; fnXx7: } goto iv8jB; XCeaZ: zFjb7: goto B4kbh; j2PN4: } }